"0",""
"0","#Create a function for plotting the seasonality charts"
"0","plotSeasonality <- function (inputs) {"
"0","  Type_select <- inputs"
"0","  airquality_season_temp <- airquality_season %>%"
"0","    left_join(country_lon_lat, by = ""Country.Code3"") %>%"
"0","    filter(Type == Type_select)"
"0","  "
"0","airquality_season_avg <- airquality_season_temp %>%"
"0","    group_by(month) %>%"
"0","    summarise("
"0","      pm25 = mean(MonthlyAveragepm25, na.rm = TRUE),"
"0","      co = mean(MonthlyAverageco, na.rm = TRUE),"
"0","      pm10 = mean(MonthlyAveragepm10, na.rm = TRUE),"
"0","      o3 = mean(MonthlyAverageo3, na.rm = TRUE),"
"0","      so2 = mean(MonthlyAverageso2, na.rm = TRUE),"
"0","      no2 = mean(MonthlyAverageno2, na.rm = TRUE))"
"0","    "
"0","    monthabb <- month.abb[as.numeric(airquality_season_avg$month)]"
"0","    "
"0","    fig <- plot_ly()"
"0","    fig <- fig %>% "
"0","      add_trace(x = ~airquality_season_avg$month, y = ~airquality_season_avg$pm25, name = ""PM2.5"", mode = ""lines+markers"", type = ""scatter"") %>% "
"0","      add_trace(x = ~airquality_season_avg$month, y = ~airquality_season_avg$pm10, name = ""PM10"", mode = ""lines+markers"", type = ""scatter"") %>% "
"0","      add_trace(x = ~airquality_season_avg$month, y = ~airquality_season_avg$co, name = ""CO"", mode = ""lines+markers"", type = ""scatter"", yaxis = ""y2"") %>% "
"0","      add_trace(x = ~airquality_season_avg$month, y = ~airquality_season_avg$o3, name = ""O3"", mode = ""lines+markers"", type = ""scatter"", yaxis = ""y2"") %>% "
"0","      add_trace(x = ~airquality_season_avg$month, y = ~airquality_season_avg$so2, name = ""SO2"", mode = ""lines+markers"", type = ""scatter"", yaxis = ""y2"") %>% "
"0","      add_trace(x = ~airquality_season_avg$month, y = ~airquality_season_avg$no2, name = ""NO2"", mode = ""lines+markers"", type = ""scatter"", yaxis = ""y2"")"
"0","    "
"0","    ay <- list("
"0","      overlaying = ""y"","
"0","      side = ""right"","
"0","      title = ""<b>CO(ppm) and O3, SO2, NO2(ppb)</b>"","
"0","      rangemode = ""tozero"", automargin = T)"
"0","    "
"0","#Set figure title, x and y-axes titles"
"0","    fig %>% layout("
"0","      title = sprintf(""<b>%s - Monthly air pollution levels<b>"",inputs), "
"0","      yaxis2 = ay,"
"0","      xaxis = list(title = "" "",tickvals = c(1,2,3,4,5,6,7, 8,9,10,11,12),ticktext = monthabb),"
"0","      yaxis = list(title=""<b>PM2.5, PM10 (mcg per cubic meter)<b>"", rangemode = ""tozero""),"
"0","      showlegend = TRUE,"
"0","      legend = list(orientation = 'h')"
"0","    )"
"0","}"
"0","#Plot ""North"""
"0","plotSeasonality(""North"")"
