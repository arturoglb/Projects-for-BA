"0",""
"0","ggplotRegression <- function (fit) {"
"0","  ggplot(fit$model, aes_string(x = names(fit$model)[2], y = names(fit$model)[1])) + "
"0","    geom_point() +"
"0","    stat_smooth(method = ""lm"", col = ""red"") +"
"0","    labs(title = paste(""Adj R2 = "",signif(summary(fit)$adj.r.squared, 5),"
"0","                       ""Intercept ="",signif(fit$coef[[1]],5 ),"
"0","                       ""Slope ="",signif(fit$coef[[2]], 5),"
"0","                       ""P-value ="",signif(summary(fit)$coef[2,4], 5)))"
"0","}"
"0",""
"0","g <- ggplotRegression(mod1)"
"0","a <- ggplotRegression(mod2)"
"0",""
"0","gg <- ggplotly(g)"
"2","`geom_smooth()` using formula 'y ~ x'
"
"0","aa <- ggplotly(a)"
"2","`geom_smooth()` using formula 'y ~ x'
"
"0","subplot(aa,gg, nrows = 1,shareY = TRUE, titleX = TRUE)%>%"
"0","        layout(title= ""Determinant factors for Air Pollution"","
"0","               annotations = list( "
"0","                 list( "
"0","                      x = 0.2,  "
"0","                      y = 1.0,  "
"0","                      text = sprintf(""      Adj R2= %.2f | p-value = %.2e"",summary(mod2)$adj.r.squared,anova(mod2)$'Pr(>F)'[1]),  "
"0","                      xref = ""paper"",  "
"0","                      yref = ""paper"",  "
"0","                      xanchor = ""center"",  "
"0","                      yanchor = ""bottom"",  "
"0","                      showarrow = FALSE),"
"0","                 list( "
"0","                      x = 0.8,  "
"0","                      y = 1,  "
"0","                      text = sprintf(""Adj R2= %.2f | p-value = %.2e     "",summary(mod1)$adj.r.squared,anova(mod1)$'Pr(>F)'[1]),  "
"0","                      xref = ""paper"",  "
"0","                      yref = ""paper"",  "
"0","                      xanchor = ""center"",  "
"0","                      yanchor = ""bottom"",  "
"0","                      showarrow = FALSE)))"
